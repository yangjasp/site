<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jasper Yang">
<meta name="dcterms.date" content="2023-06-25">

<title>Jasper Yang - Rediscovering a fun probability problem</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Jasper Yang</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/yangjasp" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/jyang29" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../JasperYangCV20250330.pdf" rel="" target="">
 <span class="menu-text">CV</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#arriving-at-the-problem" id="toc-arriving-at-the-problem" class="nav-link active" data-scroll-target="#arriving-at-the-problem">Arriving at the problem</a></li>
  <li><a href="#the-solution" id="toc-the-solution" class="nav-link" data-scroll-target="#the-solution">The Solution</a>
  <ul class="collapse">
  <li><a href="#a-misconception-of-the-misconception-of-chance" id="toc-a-misconception-of-the-misconception-of-chance" class="nav-link" data-scroll-target="#a-misconception-of-the-misconception-of-chance">A misconception of the “misconception of chance”</a></li>
  <li><a href="#viewpoint-1-tree-diagrams" id="toc-viewpoint-1-tree-diagrams" class="nav-link" data-scroll-target="#viewpoint-1-tree-diagrams">Viewpoint 1: Tree Diagrams</a></li>
  <li><a href="#viewpoint-2-stochastic-process" id="toc-viewpoint-2-stochastic-process" class="nav-link" data-scroll-target="#viewpoint-2-stochastic-process">Viewpoint 2: Stochastic Process</a></li>
  </ul></li>
  <li><a href="#now-we-know" id="toc-now-we-know" class="nav-link" data-scroll-target="#now-we-know">Now we know…</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Rediscovering a fun probability problem</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jasper Yang </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 25, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>On a recent trip, two friends and I accidentally rediscovered a neat probability factoid while playing cards:</p>
<blockquote class="blockquote">
<p>Suppose a coin is flipped until a specific sequence of length <span class="math inline">\(n\)</span> is reached. Although the probability of any sequence occuring over the next <span class="math inline">\(n\)</span> tosses is equal for any sequence at any given time (by independence), the expected number of tosses until the sequence is reached can differ by sequence.</p>
</blockquote>
<p>This “paradox” does not have a specific name as far as we can tell, but it is solidly documented and applies to many problems involving sequences of events. We had a lot of fun discovering it nonetheless, so I decided to write about thinking process that led us to it.</p>
<section id="arriving-at-the-problem" class="level2">
<h2 class="anchored" data-anchor-id="arriving-at-the-problem">Arriving at the problem</h2>
<p>During a game of Dirty Clubs on a Northern Rail train from London to Liverpool, two friends and I came up with a seemingly straightforward question pertaining to a debate about optimal strategy: what is the expected number of cards until the sequence “Ace, Jack, Jack” appears in a <em>with-replacement</em> deck <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. To make things even simpler, we started by only considering draws from an eight-card deck of Jacks and Aces.</p>
<p>Our initial approach was to draw a tree diagram to a reasonable number of draws and look for a pattern. To make things as simple as possible, we decided to consider AAA (Ace, Ace, Ace) rather than AJJ (Ace, Jack, Jack), knowing that the probability of flipping each of these sequences at a given time is equally <span class="math inline">\(\frac{1}{8}\)</span>. Our initial attempts to write the expectation as an infinite sum were unsuccessful, so we eventually made use of my brief experience with stochastic processes and used the Markov chain expected waiting time strategy to arrive at an answer of 14 flips.</p>
<p>Something immediately felt off about that answer - 14 flips seemed far too high for a string of just three cards. We re-derived and re-solved the system of equations twice, but kept getting 14. In the end, we decided that it was the unsatisfactory, yet correct, answer.</p>
<p>Still unsatisfied a few days later, we revisited the problem and realized that both our mathematical approach and our guts were half right, but neither was fully correct. The reason was extremely interesting.</p>
</section>
<section id="the-solution" class="level2">
<h2 class="anchored" data-anchor-id="the-solution">The Solution</h2>
<section id="a-misconception-of-the-misconception-of-chance" class="level3">
<h3 class="anchored" data-anchor-id="a-misconception-of-the-misconception-of-chance">A misconception of the “misconception of chance”</h3>
<p>In a 1974 paper, Daniel Kahneman and Amos Tversky describe a fallacy called the “misconception of chance”, whereby people erroneously believe that sequences of independent events that appear random such as HTHTHHT (for a fair coin toss) are more likely than sequences that non-random such as HHHHHHH. In reality, independence tells us that the probability for each of those sequences is <span class="math inline">\((\frac{1}{2})^7\)</span>, although the probability of getting the 4 heads out of 7 tosses is greater than the probability of getting 7 heads because there are more (equally likely) sequences that contain exactly 4 heads than there are sequences that contain 7 heads.</p>
<p>It was with this idea in mind that my friends and I thought that waiting for the sequence AAA was the same as waiting for the sequence AJJ. As we realized later, this fact is only true when the past/present are ignored. Two different viewpoints can be used to see why.</p>
</section>
<section id="viewpoint-1-tree-diagrams" class="level3">
<h3 class="anchored" data-anchor-id="viewpoint-1-tree-diagrams">Viewpoint 1: Tree Diagrams</h3>
<p>Tree diagrams are useful ways to visualize probabilities of (short) sequences of discrete events. It was my friend’s return to our diagram up to 4 card draws that first revealed the paradox. This diagram is pictured below:</p>
<p><img src="Figure1.png" class="img-fluid"> The key realization here is that the tree stops as soon as the sequence has been reached. Hence why the top A, which would be the fourth A in AAAA, is not circled in red. This A will never be reached if we are looking for AAA, so we have <span class="math display">\[P(\text{reach AAA in 4 or less draws}) = P(\text{reach AAA on 3rd}) + P(\text{reach AAA on 4th}) = \frac{1}{8} + \frac{7}{8}\cdot\frac{1}{14} = \frac{3}{16}.\]</span></p>
<p>On the other hand, AJJ can’t occur after another AJJ within four draws. This gives</p>
<p><span class="math display">\[P(\text{reach AJJ in 4 or less draws}) = P(\text{reach AJJ on 3rd}) + P(\text{reach AJJ in 4th}) = \frac{1}{8} + \frac{7}{8}\cdot\frac{2}{14} = \frac{4}{16}.\]</span> Essentially, AAA is less likely because two of the chances to get AAA overlap. This is not the case for AJJ, so you actually have more chances in the first four draws to get AJJ. If you are looking for AJJ and the first card is an A but the second is also an A, which breaks the sequence, you still have another chance to get AJJ in four draws because the breaking card is actually the first in the sequence. If you are looking for AAA, a breaking Jack on the second draw eliminates any chance of getting the sequence in four or less.</p>
</section>
<section id="viewpoint-2-stochastic-process" class="level3">
<h3 class="anchored" data-anchor-id="viewpoint-2-stochastic-process">Viewpoint 2: Stochastic Process</h3>
<p>A second approach to this problem is to consider a Markov chain with states corresponding to how far along the desired sequence you are:</p>
<ul>
<li>State 0: Starting state. Still need the full sequence of three, so the minimum number of turns left is three.</li>
<li>State 1: The first card of the sequence has just been drawn. If the next two are drawn correctly, the game can end in two turns.</li>
<li>State 2: The first two card of the sequence have just been drawn. If the next draw is what we are looking for, the game will end in one turn.</li>
<li>State 3: The absorbing final state. This is reached when the desired sequence has just been drawn.</li>
</ul>
<p>Using 0.5 as the probability for drawing A or J on each turn, the transition diagrams for AAA and AJJ are:</p>
<style>
.Figure2 {
  padding: 10px;
}
</style>
<p><img src="Figure2.png" class="Figure2 img-fluid"> Note the distinct differences. A break in the sequence will always knock you back to state 0 for AAA, but for AJJ, you never return to state 0 once you leave it because breaking the sequence after it has started only occurs when an A, the first card in the sequence, is drawn.</p>
<p>The expected number of draws until state 3, AAA, is reached can be found by solving the following system of equations, which follow directly from the diagram:</p>
<p><span class="math display">\[
E_0 = \frac{1}{2}(E_1 + 1) + \frac{1}{2}(E_0 + 1)
\]</span> <span class="math display">\[
E_1 = \frac{1}{2}(E_2 + 1) + \frac{1}{2}(E_0 + 1)
\]</span> <span class="math display">\[
E_2 = \frac{1}{2}(E_3 + 1) + \frac{1}{2}(E_0 + 1)
\]</span> where <span class="math inline">\(E_i\)</span> is the expected time until state 3, AAA, is reached given that the chain is currently in state <span class="math inline">\(i\)</span>. Clearly <span class="math inline">\(E_3 = 0\)</span>, so this is a system of three equations with three unknowns. Solving for <span class="math inline">\(E_0\)</span> gives 14.</p>
<p>In contrast, the system of equations for AJJ is:</p>
<p><span class="math display">\[
E_0 = \frac{1}{2}(E_1 + 1) + \frac{1}{2}(E_0 + 1)
\]</span> <span class="math display">\[
E_1 = \frac{1}{2}(E_2 + 1) + \frac{1}{2}(E_1 + 1)
\]</span> <span class="math display">\[
E_2 = \frac{1}{2}(E_3 + 1) + \frac{1}{2}(E_1 + 1)
\]</span></p>
<p>Now, solving for <span class="math inline">\(E_0\)</span> gives 8. If you are looking for AJA, the Markov diagram and corresponding system of equations give 10 as the expected number of draws.</p>
</section>
</section>
<section id="now-we-know" class="level2">
<h2 class="anchored" data-anchor-id="now-we-know">Now we know…</h2>
<p>After working out these details, our assumption that AAA was obviously the same as AJJ felt like a silly mistake. As it turns out, <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2627354">a number of researchers</a> have fallen victim to similar fallacies in the past, including Amos Tversky himself in a <a href="https://psycnet.apa.org/record/1986-05021-001">1985 paper</a> about the hot-hand in basketball. Probability is hard!</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>As every Midwesterner should know, Ace, Jack, Jack is a good sequence of cards.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>